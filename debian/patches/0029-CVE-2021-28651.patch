Description: Fix CVE-2021-28651.
 Due to a buffer-management bug, it allows
 a denial of service in URN processing.
 When resolving a request with the urn: scheme,
 the parser leaks a small amount of memory.
Author: Amos Jeffries <yadij@users.noreply.github.com>
Origin: upstream, http://www.squid-cache.org/Versions/v4/changesets/squid-4-a975fd5aedc866629214aaaccb38376855351899.patch
Bug: https://github.com/squid-cache/squid/pull/778
Bug-Debian: https://bugs.debian.org/988893
Forwarded: not-needed
Reviewed-By: Francisco Vilmar Cardoso Ruviaro <francisco.ruviaro@riseup.net>
Last-Update: 2021-05-27

--- squid-4.13.orig/src/urn.cc
+++ squid-4.13/src/urn.cc
@@ -412,6 +412,7 @@ urnParseReply(const char *inbuf, const H
     }
 
     debugs(52, 3, "urnParseReply: Found " << i << " URLs");
+    xfree(buf);
     return list;
 }
 
