From: Markus Koschany <apo@debian.org>
Date: Mon, 19 Feb 2024 12:17:10 +0100
Subject: CVE-2023-49285

Origin: http://www.squid-cache.org/Versions/v5/SQUID-2023_7.patch
---
 lib/rfc1123.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/lib/rfc1123.c b/lib/rfc1123.c
index 5fe17df..71931a6 100644
--- a/lib/rfc1123.c
+++ b/lib/rfc1123.c
@@ -50,7 +50,13 @@ make_month(const char *s)
     char month[3];
 
     month[0] = xtoupper(*s);
+    if (!month[0])
+        return -1; // protects *(s + 1) below
+
     month[1] = xtolower(*(s + 1));
+    if (!month[1])
+        return -1; // protects *(s + 2) below
+
     month[2] = xtolower(*(s + 2));
 
     for (i = 0; i < 12; i++)
